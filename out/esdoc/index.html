<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/collective-soundworks/soundworks" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">client</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientCalibration.es6.js~ClientCalibration.html">ClientCalibration</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientCheckin.es6.js~ClientCheckin.html">ClientCheckin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientControl.es6.js~ClientControl.html">ClientControl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientDialog.es6.js~ClientDialog.html">ClientDialog</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientFilelist.es6.js~Filelist.html">Filelist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientLoader.es6.js~ClientLoader.html">ClientLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientLocator.es6.js~ClientLocator.html">ClientLocator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientModule.es6.js~ClientModule.html">ClientModule</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientOrientation.es6.js~ClientOrientation.html">ClientOrientation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientPerformance.es6.js~ClientPerformance.html">ClientPerformance</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientPlacer.es6.js~ClientPlacer.html">ClientPlacer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientPlatform.es6.js~ClientPlatform.html">ClientPlatform</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientSelector.es6.js~ClientSelector.html">ClientSelector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientSetup.es6.js~ClientSetup.html">ClientSetup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientSpace.es6.js~ClientSpace.html">ClientSpace</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientSurvey.es6.js~ClientSurvey.html">ClientSurvey</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/client/ClientSync.es6.js~ClientSync.html">ClientSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EventEmitter">EventEmitter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-client">client</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">server</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerCalibration.es6.js~ServerCalibration.html">ServerCalibration</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerCheckin.es6.js~ServerCheckin.html">ServerCheckin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerClient.es6.js~ServerClient.html">ServerClient</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerControl.es6.js~ServerControl.html">ServerControl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerFilelist.es6.js~ServerFilelist.html">ServerFilelist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerLocator.es6.js~ServerLocator.html">ServerLocator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerModule.es6.js~ServerModule.html">ServerModule</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerPerformance.es6.js~ServerPerformance.html">ServerPerformance</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerPlacer.es6.js~ServerPlacer.html">ServerPlacer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerSetup.es6.js~ServerSetup.html">ServerSetup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerSurvey.es6.js~ServerSurvey.html">ServerSurvey</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/ServerSync.es6.js~ServerSync.html">ServerSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-server">server</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><div data-ice="index" class="github-markdown"><h2 id="api">API</h2>
<p>This section explains how to use the objects and classes of the library. In particular, we list here all the methods and attributes you may need to use at some point while implementing a scenario.</p>
<p>We start with the <a href="#core-objects">core objects</a>:</p>
<ul>
<li><a href="#client-side-the-client-object"><code>client</code></a> (client side)</li>
<li><a href="#server-side-the-server-object"><code>server</code></a> (server side)</li>
</ul>
<p>Then we review the <a href="#basicbase-classes">basic/base module classes</a>:</p>
<ul>
<li><a href="#the-serverclient-class"><code>ServerClient</code></a></li>
<li><a href="#the-module-base-class"><code>Module</code></a> (base class)</li>
<li><a href="#the-performance-base-class"><code>Performance</code></a> (base class)</li>
</ul>
<p>Finally, we focus on the modules implemented in the library. Some modules are only present on the <a href="#client-only-modules">client side</a>:</p>
<ul>
<li><a href="#clientdialog"><code>Dialog</code></a></li>
<li><a href="#clientloader"><code>Loader</code></a></li>
<li><a href="#clientorientation"><code>Orientation</code></a></li>
<li><a href="#clientplatform"><code>Platform</code></a></li>
</ul>
<p>Others require both the <a href="#client-and-server-modules">client <strong>and</strong> server sides</a>:</p>
<ul>
<li><a href="#checkin"><code>Checkin</code></a></li>
<li><a href="#control"><code>Control</code></a></li>
<li><a href="#setup"><code>Setup</code></a></li>
<li><a href="#sync"><code>Sync</code></a></li>
</ul>
<p>Some modules on the client side are associated with dedicated styling information. When that is the case, we added in the <a href="https://github.com/collective-soundworks/soundworks-template"><code>soundworks-template</code></a>&#x2019;s <a href="https://github.com/collective-soundworks/soundworks-template/tree/master/src/sass"><code>src/sass/</code></a> folder the corresponding <code>_77-moduleName.scss</code> SASS partial. Don&apos;t forget to include them in your <code>*.scss</code> files when you write your scenario (for more information, cf. the <a href="#styling-with-sass">Styling with SASS</a> section). We indicate in the module descriptions below which of them require custom SASS partials.</p>
<h3 id="core-objects">Core objects</h3>
<p>The core objects on the client side and the server side are singletons that contain the methods used to set up a scenario and to exchange messages between the client and the server.</p>
<h3 id="basic-base-classes">Basic/base classes</h3>
<h4 id="the-module-base-class">The <code>Module</code> base class</h4>
<p>The <code>Module</code> server and client classes are the base classes that any <em>Soundworks</em> module should extend. These base classes define interfaces to be implemented by the derived modules, and provide a set of attributes and methods that facilitate the implementation of modules.</p>
<h3 id="client-server-modules">Client/server modules</h3>
<h4 id="checkin">Checkin</h4>
<h5 id="clientcheckin">ClientCheckin</h5>
<p>Below is an example of an instantiation of the <code>ClientCheckin</code> module that displays the dialog on the client side.</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">/* Client side */

// Require the Soundworks library (client side)
var clientSide = require(&apos;soundworks/client&apos;);

// Instantiate the module
var checkin = new clientSide.Checkin({ select: &apos;automatic&apos;, order: &apos;random&apos; });</code>
</code></pre>
<h5 id="servercheckin">ServerCheckin</h5>
<p>Below is an example of the instantiation of the <code>ServerCheckin</code> module on the server side.</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">/* Server side */

// Require the Soundworks library (server side)
var serverSide = require(&apos;soundworks/server&apos;);

// Case 1: the scenario has a predefined setup
var setup = new serverSide.Setup();
setup.generate(&apos;matrix&apos;, { cols: 3, rows: 4 }).
var checkin = new serverSide.Checkin({ setup: setup });

// Case 2: the scenario does not have a predefined setup, but specifies a maximum number of clients
var checkin = new serverSide.Checkin({ maxClients: 500 });</code>
</code></pre>
<h4 id="setup">Setup</h4>
<h5 id="clientsetup">ClientSetup</h5>
<p>The <code>ClientSetup</code> modules extends the <code>ClientModule</code> base class and takes care of receiving the setup on the client side, and provides helper functions to display the setup on screen. The <code>ClientSetup</code> calls its <code>done</code> method when it receives the setup from the server.</p>
<p>The <code>ClientSetup</code> module requires the SASS partial <code>sass/_77-setup.scss</code>.</p>
<h6 id="methods">Methods</h6>
<ul>
<li><code>addClassToPosition(setupDisplay:Element, index: Number, className:String = &apos;player&apos;)</code><br>The <code>addClassToPosition</code> method adds the class <code>className</code> to the position <code>index</code> in the <code>setupDisplay</code> DOM element (this graphical representation of the setup had to be created with the <code>display</code> method).</li>
<li><code>removeClassFromPosition(setupDisplay:Element, index: Number, className:String = &apos;player&apos;)</code><br>The <code>removeClassFromPosition</code> method removes the class <code>className</code> from the position <code>index</code> in the <code>setupDisplay</code> DOM element (this graphical representation of the setup had to be created with the <code>display</code> method).</li>
</ul>
<p>Below is an example of the <code>ClientSetup</code> module in use.</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">/* Client side */

// Require the Soundworks library (client side)
var clientSide = require(&apos;soundworks/client&apos;);

// Instantiate the module
var setup = new clientSide.Setup();

// Display a graphical representation of the setup in a `div` of the DOM
var setupGUI = document.getElementById(&apos;setup-container&apos;);
setup.display(setupGUI);

// Add the class &apos;red-highlight&apos; to position #3 in this graphical representation
setup.addClassToPosition(setupGUI, 3, &apos;red-highlight&apos;);</code>
</code></pre>
<h5 id="serversetup">ServerSetup</h5>
<p>The <code>ServerSetup</code> extends the <code>ServerModule</code> base class and takes care of the setup on the server side. In particular, the module provides helper functions that can generate a setup automatically from some parameters.</p>
<h6 id="methods">Methods</h6>
<ul>
<li><code>constructor(options:Object = {})</code><br>The <code>constructor</code> accepts the following <code>options</code>:<ul>
<li><code>name:String</code>, <code>name</code> of the module.</li>
</ul>
</li>
<li><code>generate(type:String = &apos;matrix&apos;, params = {})</code><br>The <code>generate</code> method generates a surface and/or predefined positions according to a given type of geometry <code>type</code> and the corresponding parameters <code>params</code>. The following geometries are available:<ul>
<li><code>&apos;matrix&apos;</code>, a matrix setup with the following parameters (in the <code>params</code> object):<ul>
<li><code>cols = 3</code>, number of columns;</li>
<li><code>rows = 4</code>, number of rows;</li>
<li><code>colSpacing = 1</code>, spacing between columns;</li>
<li><code>rowSpacing = 1</code>, spacing between rows;</li>
<li><code>colMargin = colSpacing / 2</code>, (horizontal) margins between the borders of the performance space and the first or last column;</li>
<li><code>rowMargin = rowSpacing / 2</code>, (vertical) margins between the borders of the performance space and the first or last row.</li>
</ul>
</li>
</ul>
</li>
<li><code>getNumPositions() : Number</code><br>The <code>getNumPositions</code> method returns the total number of predefined positions and/or labels of the setup. For instance, if the setup is a 4 &#x2A09; 5 matrix the method would return 20.</li>
<li><code>getLabel(index:Number) : String</code><br>The <code>getLabel</code> method returns a <code>String</code> corresponding to the label associated with the predefined position of the setup whose index is <code>index</code>.</li>
<li><code>getCoordinates(index:Number) : Array</code><br>The <code>getCoordinates</code> returns an array with the coordinates of the predefined position of the setup whose index is <code>index</code>.</li>
</ul>
<p>Below is an example of the instantiation of the <code>ServerSetup</code> module on the server side.</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">/* Server side */

// Require the Soundworks library (server side)
var serverSide = require(&apos;soundworks/server&apos;);

// Creating a matrix setup with 4 columns and 5 rows
var setup = new serverSide.Setup();
setup.generate(&apos;matrix&apos;, { cols: 4, rows: 5 });</code>
</code></pre>
<h4 id="sync">Sync</h4>
<p>The <code>Sync</code> module is based on <a href="https://github.com/collective-soundworks/sync"><code>github.com/collective-soundworks/sync</code></a> and is responsible for synchronizing the clients&#x2019; clocks and the server clock on a common clock called <em>sync clock</em>. Both the clients and the server can use this shared clock as a common time reference. For instance, this allows all the clients to do something exactly at the same time, such as blinking the screen or playing a sound in a synchronized manner.</p>
<p>The <code>Sync</code> module does a first synchronization process after which the <code>ClientSync</code> calls its <code>done</code> method. Afterwards, the <code>Sync</code> module keeps running in the background for the rest of the scenario to resynchronize the client and server clocks regularly, to compensate for clock drifts.</p>
<p>On the client side, <code>ClientSync</code> uses the <code>audioContext</code> clock. On the server side, <code>ServerSync</code> uses the <code>process.hrtime()</code> clock. All times are in seconds (method arguments and returned values). <strong>All time calculations and exchanges should be expressed in the sync clock time.</strong></p>
<h5 id="clientsync">ClientSync</h5>
<p>++
The <code>ClientSync</code> module extends the <code>ClientModule</code> base class and takes care of the synchronization process on the client side. It displays a view that indicates &quot;Clock syncing, stand by&#x2026;&quot; until the very first synchronization process is done. The <code>ClientSync</code> module calls its <code>done</code> method as soon as the client clock is in sync with the sync clock. Then, the synchronization process keeps running in the background to resynchronize the clocks from times to times. When such a resynchronization happens, the <code>ClientSync</code> module emits a <code>&apos;sync:stats&apos;</code> event associated with information about the synchronization.</p>
<h6 id="methods">Methods</h6>
<p>++</p>
<ul>
<li><code>constructor(options:Object = {})</code><br>The <code>constructor</code> accepts the following <code>options</code>:<ul>
<li><code>name:String = &apos;sync&apos;</code>, <code>name</code> of the module;</li>
<li><code>color:String = &apos;black&apos;</code>, <code>viewColor</code> of the module.</li>
</ul>
</li>
<li><code>getLocalTime(syncTime:Number) : Number</code><br>The <code>getLocalTime</code> method returns the time of the local (client) clock (in seconds) corresponding to the given sync time. If no arguments are provided, the method returns the current local (client) time (<em>i.e.</em> using <code>audioContext.currentTime</code>).</li>
<li><code>getSyncTime(localTime:Number = audioContext.currentTime) : Number</code><br>The <code>getSyncTime</code> method returns the time of the sync clock (in seconds) corresponding to the given local (client) time. If no arguments are provided, the method returns the current sync time.
++
Below is an example of an instantiation of the <code>Sync</code> module on the client side.
++
```javascript
/<em> Client side </em>/</li>
</ul>
<p>// Require the Soundworks library (client side)
var clientSide = require(&apos;soundworks/client&apos;);</p>
<p>// Create Sync module
var sync = new clientSide.Sync();</p>
<p>// Get times
var nowClient = sync.getLocalTime(); // current time in client clock time
var nowSync = sync.getSyncTime(); // current time in sync clock time</p>
<pre><code><code class="source-code prettyprint">
###### Events

- `&apos;sync:stats&apos; : stats:Object`  
  The `ClientSync` module emits the `&apos;sync:stats&apos;` event each time it resynchronizes the local clock on the sync clock. In particular, the first time this event is fired indicates that the clock has been synchronized with the sync clock (*i.e.* we have a first estimation of the clock synchronization) and the `done` method is called. The `&apos;sync:stats&apos;` event has a single object argument with the following properties:
  - `timeOffset`, current estimation of the time offset between the client clock and the sync clock;
  - `travelTime`, current estimation of the travel time for a message to go from the client to the server and back;
  - `travelTimeMax`, current estimation of the maximum travel time for a message to go from the client to the server and back.

##### ServerSync
++
The `ServerSync` module extends the `ServerModule` base class and takes care of the synchronization process on the server side.

###### Methods
++
- `constructor(options:Object = {})`  
  The `constructor` accepts the following `options`:
  - `name:String`, `name` of the module.
- `getSyncTime() : Number`  
  The `getSyncTime` method returns the current sync time (in seconds, derived from `process.hrtime` method).
++
Below is an example of the instantiation of the `Sync` module on the server side.
++
```javascript
/* Server side */

// Require the Soundworks library (server side)
var serverSide = require(&apos;soundworks/server&apos;);

// Create Sync module
var sync = new serverSide.Sync();

// Get sync time
var nowSync = sync.getSyncTime(); // current time in the sync clock time</code>
</code></pre></div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.3)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
